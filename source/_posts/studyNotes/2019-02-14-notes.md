---
layout: blog
# istop: true
title: "日常学习笔记"
mark: 原创
# background-image: https://o243f9mnq.qnssl.com/2017/06/116099051.jpg
background: notes
date:  2019-02-14
category: 学习笔记
tags:
- js
- date
- 时间格式化
---

# 2019-02-14
## 苹果手机和安卓手机对于new Date()处理的一个小bug
```js
alert(new Date('2019-02-14'))  //iphone:  Thu Feb 14 2019 08:00:00 GMT+0800(CST)
alert(new Date('2019-02-14'))  //Android: Thu Feb 14 2019 08:00:00 GMT+0800(CST)

alert(new Date('2019-02-14 11:00:05'))  //iphone: Invalid Date
alert(new Date('2019-02-14 11:00:05'))  //Android: Thu Feb 14 2019 11:00:05 GMT+0800(CST)

alert(new Date('2019-02-14 11:00:05.0'))  //iphone: Invalid Date
alert(new Date('2019-02-14 11:00:05.0'))  //Android: Thu Feb 14 2019 11:00:05 GMT+0800(CST)

alert(new Date('2019/02/14'))  //iphone:  Thu Feb 14 2019 08:00:00 GMT+0800(CST)
alert(new Date('2019/02/14'))  //Android: Thu Feb 14 2019 08:00:00 GMT+0800(CST)

alert(new Date('2019/02/14 11:00:05'))  //iphone:  Thu Feb 14 2019 11:00:05 GMT+0800(CST)
alert(new Date('2019/02/14 11:00:05'))  //Android: Thu Feb 14 2019 11:00:05 GMT+0800(CST)

alert(new Date('2019/02/14 11:00:05.0'))  //iphone:  Invalid Date
alert(new Date('2019/02/14 11:00:05.0'))  //Android: Thu Feb 14 2019 11:00:05 GMT+0800(CST)
```
可以看到，对于格式化`yyyy-mm-dd`格式，苹果和安卓的结果都是正常的，而只要日期后面加上时分秒苹果就会输出异常。  
而对于`yyyy/mm/dd`格式，不管加不加时分秒，苹果和安卓都是正常，但是加上毫秒（因为有些数据库的时间格式默认到了毫秒）后苹果又会异常。

### 解决方案
#### 对于没有精确到毫秒的时间使用正则替换“-”为“/”
```js
function formatIOS(date) {
  retuen new Date(date.replace(/-/g, "/"))
}
```
#### 对于精确到了毫秒的时间只能舍弃毫秒而截取前面19位了
```js
function formatIOS(date) {
  retuen date.substr(0, 19)
}
```
